!OpSequence
idstr: network
name: Stream Network Definition by Drop Analysis
doc: Defines the stream based on the Peuker Douglass algorithm, then computes the stream network.
input:
  flow-direction: flow-direction
  source-area: source-area
  soil-depth: soil-depth
  outlet: outlet
tree:
  - operation: eccw-to-ncw
    in:
      flow-dir-ds: flow-direction
    out:
      flow-direction: flow-dir-for-distance
  - label: flow-distance
    operation: flow-distance-euclidean
    in:
      flow-dir-ds: flow-dir-for-distance
  - operation: stream-definition-threshold
    in:
      flow-acc-ds: source-area
    out:
      stream-raster: stream-raster
  - label: stream-definition-threshold
    operation: stream-definition-threshold
    in:
      flow-acc-ds: source-area
  - label: outlet-on-stream
    operation: snap-outlet
    in:
      flow-dir-ds: flow-direction
      stream-ds: stream-definition-threshold
      outlet-ds: outlet
  - label: labelled-outlet
    operation: label-outlet
    in:
      outlet-ds: outlet-on-stream
    out:
      labelled-outlet: labelled-outlet
  - label: stream-definition
    operation: stream-def-pd
    in:
      no-sinks-ds: no-sinks
      flow-dir-ds: flow-direction
      source_area-ds: source-area
      outlet-ds: labelled-outlet
    out:
      stream-definition: stream-definition
  - label: stream-network
    operation: stream-network
    in:
      no-sinks-ds: no-sinks
      flow-dir-ds: flow-direction
      source-area-ds: source-area
      outlet-ds: labelled-outlet
      pd-stream-def-ds: stream-definition
    out:
      order: order
      tree: tree
      coord: coord
      network: stream-network
      watershed: watershed
  - label: soil-depth
    operation: soil-depth
    in:
      slop
  - label: dhsvm-network
    operation: dhsvm-network
    in:
      tree: tree
      coord: coord
      network: stream-network
      watershed: watershed
      flow-distance-ds: flow-distance
      soil-depth-ds: soil-depth
    out:
      network: network
      map: map
      state: state
out:
  - network
  - map
  - state
